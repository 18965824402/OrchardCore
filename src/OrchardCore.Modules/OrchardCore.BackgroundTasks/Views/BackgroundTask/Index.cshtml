@model BackgroundTaskIndexViewModel
@inject OrchardCore.Modules.ILocalClock LocalClock

<h1>@RenderTitleSegments(T["Background Tasks"])</h1>

<form asp-action="Index"> @* the form is necessary to generate an antiforgery token for the delete action *@

    @if (Model.Tasks.Any())
    {
        <ul class="list-group">
            @foreach (var entry in Model.Tasks)
            {
                <li class="list-group-item">
                    <div class="properties">
                        <div class="related">
                        @if (@entry.Settings.Enable)
                        {
                            <a asp-action="Disable" asp-route-name="@entry.Name" class="btn btn-danger btn-sm" itemprop="UnsafeUrl">@T["Disable"]</a>
                        }
                        else
                        {
                            <a asp-action="Enable" asp-route-name="@entry.Name" class="btn btn-success btn-sm" itemprop="UnsafeUrl">@T["Enable"]</a>
                        }

                            <a asp-action="Edit" asp-route-name="@entry.Name" class="btn btn-primary btn-sm">@T["Edit"]</a>
                        </div>
                        <span class="text-primary" title="@T["Settings"]"><i class="fa fa-cog" aria-hidden="true"></i></span>
                        <span class="text-primary"><a asp-action="Edit" asp-route-name="@entry.Name">@entry.Name</a></span>
                        <span class="hint">@T["â€” {0}", entry.Settings.Description]</span>
                    </div>

                </li>

                if (!string.IsNullOrWhiteSpace(entry.State.FaultMessage))
                {
                    <li class="alert alert-danger" role="alert">
                        @entry.State.FaultMessage
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </li>
                }
            }
        </ul>
    }
    else
    {
        <div class="alert alert-info" role="alert">
            @T["<strong>Nothing here!</strong> There are no background task for the moment."]
        </div>
    }
</form>

@await DisplayAsync(Model.Pager)
